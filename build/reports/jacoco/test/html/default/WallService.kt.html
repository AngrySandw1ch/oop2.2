<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="ru"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>WallService.kt</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">hometaskOOP.1</a> &gt; <a href="index.source.html" class="el_package">default</a> &gt; <span class="el_source">WallService.kt</span></div><h1>WallService.kt</h1><pre class="source lang-java linenums">import attachments.*
import postExceptions.CommentNotFoundException
import postExceptions.PostNotFoundException

<span class="fc" id="L5">object WallService {</span>
<span class="fc" id="L6">    private var posts = emptyArray&lt;Post&gt;()</span>
<span class="fc" id="L7">    private var attachments = emptyArray&lt;Attachment&gt;()</span>
<span class="fc" id="L8">    private var comments = emptyArray&lt;Comment&gt;()</span>
<span class="fc" id="L9">    private var reports = emptyArray&lt;Comment&gt;()</span>

    fun add(post: Post): Post {
<span class="pc bpc" id="L12" title="1 of 6 branches missed.">        val postWithId = if (posts.isEmpty()) post.copy(id = 1) else post.copy(id = posts.last().id?.plus(1))</span>
<span class="fc" id="L13">        posts += postWithId</span>
<span class="fc" id="L14">        return posts.last()</span>
    }

    fun update(incomingPost: Post): Boolean {
<span class="fc bfc" id="L18" title="All 2 branches covered.">        for ((index, post) in posts.withIndex()) {</span>
<span class="fc bfc" id="L19" title="All 2 branches covered.">            if (incomingPost.id == post.id) {</span>
<span class="fc" id="L20">                posts[index] = post.copy(</span>
<span class="fc" id="L21">                    ownerId = 111,</span>
<span class="fc" id="L22">                    fromId = 222,</span>
<span class="fc" id="L23">                    createdBy = 333,</span>
<span class="fc" id="L24">                    text = &quot;new text&quot;,</span>
<span class="fc" id="L25">                    replyOwnerId = 555,</span>
<span class="fc" id="L26">                    replyPostId = 666,</span>
<span class="fc" id="L27">                    friendsOnly = 777</span>
                )
<span class="fc" id="L29">                return true</span>
            }
        }
<span class="fc" id="L32">        return false</span>
    }

    fun addAttachment(attachment: Attachment): Attachment {
<span class="fc" id="L36">        attachments += attachment</span>
<span class="fc" id="L37">        return attachments.last()</span>
    }

    fun createComment(comment: Comment) {
<span class="pc bpc" id="L41" title="1 of 2 branches missed.">        for (post: Post in posts) {</span>
<span class="nc bnc" id="L42" title="All 4 branches missed.">            if(post.id != comment.fromId) {</span>
<span class="nc" id="L43">                continue</span>
            } else {
<span class="nc" id="L45">                comments += comment</span>
<span class="nc" id="L46">                return</span>
            }
        }
<span class="fc" id="L49">        throw PostNotFoundException(&quot;РџРѕСЃС‚ РЅРµ РЅР°Р№РґРµРЅ, РєРѕРјРјРµРЅС‚Р°СЂРёР№ РЅРµ РґРѕР±Р°РІР»РµРЅ&quot;)</span>
    }

    fun reportComment(incomingComment: Comment, reason: Int) {
<span class="nc bnc" id="L53" title="All 2 branches missed.">        for (comment in comments) {</span>
<span class="nc bnc" id="L54" title="All 2 branches missed.">            if (comment.id != incomingComment.id) {</span>
<span class="nc" id="L55">                continue</span>
            } else {
<span class="nc bnc" id="L57" title="All 4 branches missed.">                if (reason &lt; 0 || reason &gt; 7) {</span>
<span class="nc" id="L58">                    return</span>
                }
<span class="nc bnc" id="L60" title="All 9 branches missed.">               val reportedComment = when(reason) {</span>
<span class="nc" id="L61">                   0 -&gt; incomingComment.copy(reportReason = &quot;СЃРїР°Рј&quot;)</span>
<span class="nc" id="L62">                   1 -&gt; incomingComment.copy(reportReason = &quot;РґРµС‚СЃРєР°СЏ РїРѕСЂРЅРѕРіСЂР°С„РёСЏ&quot;)</span>
<span class="nc" id="L63">                   2 -&gt; incomingComment.copy(reportReason = &quot;СЌРєСЃС‚СЂРµРјРёР·Рј&quot;)</span>
<span class="nc" id="L64">                   3 -&gt; incomingComment.copy(reportReason = &quot;РЅР°СЃРёР»РёРµ&quot;)</span>
<span class="nc" id="L65">                   4 -&gt; incomingComment.copy(reportReason = &quot;РїСЂРѕРїР°РіР°РЅРґР° РЅР°СЂРєРѕС‚РёРєРѕРІ&quot;)</span>
<span class="nc" id="L66">                   5 -&gt; incomingComment.copy(reportReason = &quot;РјР°С‚РµСЂРёР°Р» РґР»СЏ РІР·СЂРѕСЃР»С‹С…&quot;)</span>
<span class="nc" id="L67">                   6 -&gt; incomingComment.copy(reportReason = &quot;РѕСЃРєРѕСЂР±Р»РµРЅРёРµ&quot;)</span>
<span class="nc" id="L68">                   7 -&gt; incomingComment.copy(reportReason = &quot;РїСЂРёР·С‹РІ Рє СЃСѓРёС†РёРґСѓ&quot;)</span>
<span class="nc" id="L69">                   else -&gt; incomingComment.copy(reportReason = null)</span>
               }
<span class="nc" id="L71">                reports += reportedComment</span>
<span class="nc" id="L72">                return</span>
            }
        }
<span class="nc" id="L75">        throw CommentNotFoundException(&quot;РљРѕРјРјРµРЅР°С‚СЂРёР№ СЃ Р·Р°РґР°РЅРЅС‹Рј Id РЅРµ РЅР°Р№РґРµРЅ&quot;)</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.5.201910111838</span></div></body></html>